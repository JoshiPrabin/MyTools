using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;

class Program
{
    // BS calendar data: year => days in each month
    public static readonly Dictionary<int, int[]> BsData = new()
    {
        {2001, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2002, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2003, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2004, new[]{30,32,31,32,31,30,30,30,29,30,29,31}},
        {2005, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2006, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2007, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2008, new[]{31,31,31,32,31,31,29,30,30,29,29,31}},
        {2009, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2010, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2011, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2012, new[]{31,31,31,32,31,31,29,30,30,29,30,30}},
        {2013, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2014, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2015, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2016, new[]{31,31,31,32,31,31,29,30,30,29,30,30}},
        {2017, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2018, new[]{31,32,31,32,31,30,30,29,30,29,30,30}},
        {2019, new[]{31,32,31,32,31,30,30,30,29,30,29,31}},
        {2020, new[]{31,31,31,32,31,31,30,29,30,29,30,30}},
        {2021, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2022, new[]{31,32,31,32,31,30,30,30,29,29,30,30}},
        {2023, new[]{31,32,31,32,31,30,30,30,29,30,29,31}},
        {2024, new[]{31,31,31,32,31,31,30,29,30,29,30,30}},
        {2025, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2026, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2027, new[]{30,32,31,32,31,30,30,30,29,30,29,31}},
        {2028, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2029, new[]{31,31,32,31,32,30,30,29,30,29,30,30}},
        {2030, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2031, new[]{30,32,31,32,31,30,30,30,29,30,29,31}},
        {2032, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2033, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2034, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2035, new[]{30,32,31,32,31,31,29,30,30,29,29,31}},
        {2036, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2037, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2038, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2039, new[]{31,31,31,32,31,31,29,30,30,29,30,30}},
        {2040, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2041, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2042, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2043, new[]{31,31,31,32,31,31,29,30,30,29,30,30}},
        {2044, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2045, new[]{31,32,31,32,31,30,30,29,30,29,30,30}},
        {2046, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2047, new[]{31,31,31,32,31,31,30,29,30,29,30,30}},
        {2048, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2049, new[]{31,32,31,32,31,30,30,30,29,29,30,30}},
        {2050, new[]{31,32,31,32,31,30,30,30,29,30,29,31}},
        {2051, new[]{31,31,31,32,31,31,30,29,30,29,30,30}},
        {2052, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2053, new[]{31,32,31,32,31,30,30,30,29,29,30,30}},
        {2054, new[]{31,32,31,32,31,30,30,30,29,30,29,31}},
        {2055, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2056, new[]{31,31,32,31,32,30,30,29,30,29,30,30}},
        {2057, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2058, new[]{30,32,31,32,31,30,30,30,29,30,29,31}},
        {2059, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2060, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2061, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2062, new[]{31,31,31,32,31,31,29,30,29,30,29,31}},
        {2063, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2064, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2065, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2066, new[]{31,31,31,32,31,31,29,30,30,29,29,31}},
        {2067, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2068, new[]{31,31,32,32,31,30,30,29,30,29,30,30}},
        {2069, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2070, new[]{31,31,31,32,31,31,29,30,30,29,30,30}},
        {2071, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2072, new[]{31,32,31,32,31,30,30,29,30,29,30,30}},
        {2073, new[]{31,32,31,32,31,30,30,30,29,29,30,31}},
        {2074, new[]{31,31,31,32,31,31,30,29,30,29,30,30}},
        {2075, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2076, new[]{31,32,31,32,31,30,30,30,29,29,30,30}},
        {2077, new[]{31,32,31,32,31,30,30,30,29,30,29,31}},
        {2078, new[]{31,31,31,32,31,31,30,29,30,29,30,30}},
        {2079, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2080, new[]{31,32,31,32,31,30,30,30,29,29,30,30}},
        {2081, new[]{31,32,31,32,31,30,30,30,29,30,29,31}},
        {2082, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2083, new[]{31,31,32,31,31,31,30,29,30,29,30,30}},
        {2084, new[]{31,31,32,31,31,30,30,30,29,30,30,30}},
        {2085, new[]{31,32,31,32,30,31,30,30,29,30,30,30}},
        {2086, new[]{30,32,31,32,31,30,30,30,29,30,30,30}},
        {2087, new[]{31,31,32,31,31,31,30,30,30,30,30,30}},
        {2088, new[]{30,31,32,32,30,31,30,30,29,30,30,30}},
        {2089, new[]{30,32,31,32,31,30,30,30,29,30,30,30}}
    };

    private static readonly DateTime BaseAdDate = new DateTime(1944, 4, 13);
    private const int BaseBsYear = 2001;
    private const int BaseBsMonth = 1;
    private const int BaseBsDay = 1;

    static void Main()
    {
        using var writer = new StreamWriter("NepaliDateMapping_2000_2089.sql");
        writer.WriteLine("CREATE TABLE NepaliDateMapping (EnglishDate DATE PRIMARY KEY, NepaliYear INT, NepaliMonth INT, NepaliDay INT, NepaliDateString NVARCHAR(15));");
        writer.WriteLine();

        for (int year = 2001; year <= 2089; year++)
        {
            var months = BsData[year];
            for (int month = 1; month <= 12; month++)
            {
                int daysInMonth = months[month - 1];
                for (int day = 1; day <= daysInMonth; day++)
                {
                    DateTime adDate = BsToAd(year, month, day);
                    string nepaliDateString = $"{year}-{month:D2}-{day:D2}";
                    string sql = $"INSERT INTO NepaliDateMapping (EnglishDate, NepaliYear, NepaliMonth, NepaliDay, NepaliDateString) VALUES ('{adDate:yyyy-MM-dd}', {year}, {month}, {day}, '{nepaliDateString}');";
                    writer.WriteLine(sql);
                }
            }
        }

        Console.WriteLine("SQL script generated successfully: NepaliDateMapping_2000_2089.sql");
    }

    private static DateTime BsToAd(int bsYear, int bsMonth, int bsDay)
    {
        int totalDays = 0;

        for (int year = BaseBsYear; year < bsYear; year++)
        {
            totalDays += BsData[year].Sum();
        }

        for (int month = 1; month < bsMonth; month++)
        {
            totalDays += BsData[bsYear][month - 1];
        }

        totalDays += bsDay - 1;

        return BaseAdDate.AddDays(totalDays);
    }
}
